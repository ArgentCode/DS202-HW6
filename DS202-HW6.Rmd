---
title: "DS202-HW6"
author: "Craig Orman, Ngoc Nguyen"
date: "2/28/2022"
output: html_document
---
Link to the [Github Project](https://github.com/ArgentCode/DS202-HW6 "Github Project")
link to the [homework](https://yumouqiu.github.io/DS202-Spring2022/Practice/practice03.html) is found under the heading '02/28 Lecture 3-4-Practice for dplyr' 


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Instaniate stuff
library(tidyverse)
library(ggmosaic)
library(reshape2)
happy <- readRDS("data/HAPPY.rds")
```
### Question 1

Data cleaning: the values “IAP”, “DK” and “NA” all encode missing values. Replace all of these instances by the value NA.

```{r}

# another option
#happy[happy == "IAP"] = NA
#happy[happy == "NA"] = NA
#happy[happy == "DK"] = NA

happy = replace(happy, happy =="IAP", NA)
happy = replace(happy, happy =="NA", NA)
happy = replace(happy, happy =="DK", NA)
```

### Question 2

Check the type of the variable and cast into the right type (factor variable for categorical variables). For age, change “89 OR OLDER” to 89 and assume the variable should be numeric.


```{r}

happy = 
  happy %>% mutate(AGE = replace(AGE, AGE == "89 OR OLDER", 89)) %>% 
  mutate(AGE = as.numeric(AGE),
         HAPPY = as.factor(HAPPY),
         SEX = as.factor(SEX),
         MARITAL = as.factor(MARITAL),
         DEGREE = as.factor(DEGREE),
         FINRELA = as.factor(FINRELA),
         HEALTH = as.factor(HEALTH),
         PARTYID = as.factor(PARTYID),
         POLVIEWS = as.factor(POLVIEWS))
```

### Question 3

Bring all levels of factors into a sensible order. For marital you could e.g. order the levels according to average age.

make happy letters small letters
marital is fine
degree needs rework
```{r}

happy$DEGREE <- factor(happy$DEGREE, levels=c("LT HIGH SCHOOL",
                           "HIGH SCHOOL",
                           "JUNIOR COLLEGE",
                           "BACHELOR",
                           "GRADUATE"))

happy$FINRELA <- factor(happy$FINRELA, levels=c("FAR BELOW AVERAGE",
                                                "BELOW AVERAGE",
                                                "AVERAGE",
                                                "ABOVE AVERAGE",
                                                "FAR ABOVE AVERAGE"))

happy$HEALTH <- factor(happy$HEALTH, levels=c("POOR",
                                              "FAIR",
                                              "GOOD",
                                              "EXCELLENT"))


happy$PARTYID <- factor(happy$PARTYID, levels=c("STRONG DEMOCRAT",
                                                "NOT STR DEMOCRAT",
                                                "IND,NEAR DEM",
                                                "INDEPENDENT",
                                                "IND,NEAR REP",
                                                "NOT STR REPUBLICAN",
                                                "STRONG REPUBLICAN",
                                                "OTHER PARTY"))

happy$POLVIEWS <- factor(happy$POLVIEWS, levels=c("EXTREMELY LIBERAL",
                                                  "LIBERAL",
                                                  "SLIGHTLY LIBERAL",
                                                  "MODERATE",
                                                  "SLGHTLY CONSERVATIVE",
                                                  "CONSERVATIVE",
                                                  "EXTRMLY CONSERVATIVE"))

```

# Save the final data set as RDS file (binary R data) using the command:saveRDS

### Craigs question

We are investigating happiness and I am curious if there is a correlation between happiness and martial status and/or wealth. First, I will attempt to see if wealth and marital status are correlated. If they are highly correlated I can only use one of them (independence assumption of statistics). 

```{r}
ggplot(na.omit(happy), aes(x=MARITAL, fill=FINRELA)) +
  geom_bar(position = "fill")  +
  ylab("Percentage") +
  ggtitle("Martial and Financial status") #As a percentage
```

From a quick glance, we see that married people are weak-moderate correlated with being better off than single people who are slighly better off than separated/divorced people. I do not see any large disparities, so I think we can move on.

```{r}
ggplot(happy) + geom_mosaic(aes(x = FINRELA, fill = MARITAL, weight = 1))
```